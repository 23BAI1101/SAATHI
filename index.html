<!DOCTYPE html>

<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Saathi Fitness App</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="container">
        <!-- Personalization Step -->
        <section id="personalization">
            <h1>Welcome to SAATHI</h1>
            <p>Letâ€™s start with some details to customize your workout.</p>

            <form id="personalize-form">
                <label for="feeling">How are you feeling today?</label>
                <select id="feeling" required>
                    <option value="energetic">Energetic</option>
                    <option value="tired">Tired</option>
                    <option value="sore">Sore</option>
                </select>

                <label for="focus">Select an exercise:</label>
                <select id="focus" required>
                    <option value="bicep">Bicep Curls</option>
                    <option value="tricep">Tricep Throwback</option>
                    <option value="rowing">Rowing</option>
                    <option value="chest">Chest Press</option>
                    <option value="lateral-raises">Lateral Raises</option>
                </select>

                <label for="fitness-level">Fitness Level</label>
                <select id="fitness-level" required>
                    <option value="beginner">Beginner</option>
                    <option value="intermediate">Intermediate</option>
                    <option value="advanced">Advanced</option>
                </select>

                <button type="submit">Next</button>
            </form>
        </section>

        <!-- Exercise Recommendation Step -->
        <section id="exercise" style="display: none;">
            <h2>Selected Exercise: <span id="exercise-name"></span></h2>

            <label for="weights">Select Weights (kg):</label>
            <input type="range" id="weights" min="1" max="50" value="5">
            <p>Selected Weight: <span id="selected-weight">5</span> kg</p>

            <button id="watch-video">Watch Video Tutorial</button>
            <button id="skip-video">Skip Video Tutorial</button>
            <button id="finish-workout-exercise">Finish Workout</button>
        </section>

        <!-- Video Page -->
        <section id="video-page" style="display: none;">
            <h2>Exercise Video</h2>
            <iframe id="video-frame" width="100%" height="200" frameborder="0" allowfullscreen></iframe>
            <button id="continue-video">Continue</button>
        </section>

        <!-- Posture Correction Page -->
        <section id="posture-correction" style="display: none;">
            <h2>Posture Correction</h2>
            <p>Would you like to enable posture correction? This requires access to your camera.</p>
            <button id="enable-camera">Switch On Camera</button>
            <button id="skip-camera">Skip and Continue</button>
        </section>

        <!-- Camera Page -->
        <section id="camera-page" style="display: none;">
            <h2>Camera Feed</h2>
            <video id="camera-feed" width="100%" autoplay></video>
            <div id="camera-countdown"></div>
            <button id="continue-camera">Continue</button>
        </section>

        <!-- Countdown and Log Page -->
        <section id="countdown-log" style="display: none;">
            <div id="countdown-timer"></div>
            <button id="done-exercise">Done</button>
        </section>

        <!-- Exercise Log Page -->
        <section id="log-page" style="display: none;">
            <h2>Exercise Log</h2>
            <ul id="exercise-log"></ul>
            <button id="do-another-exercise">Do Another Exercise</button>
            <button id="finish-workout-log">Finish Workout</button>
        </section>

        <!-- Workout Summary Page -->
        <section id="workout-summary" style="display: none;">
            <h2>Workout Summary</h2>
            <ul id="summary-log"></ul>
        </section>
    </div>

    <!-- Notification for Affirmation -->
    <div id="affirmation-notification" class="notification">
        <p id="affirmation-message"></p>
    </div>

    <script>
        const exercises = {
            bicep: { name: 'Bicep Curls', video: 'https://www.youtube.com/embed/rfRdD5PKrko', requiresWeights: true },
            tricep: { name: 'Tricep Throwback', video: 'https://www.youtube.com/embed/xh1dy6dXuhc', requiresWeights: true },
            rowing: { name: 'Rowing', video: 'https://www.youtube.com/embed/UCXxvVItLoM', requiresWeights: true },
            chest: { name: 'Chest Press', video: 'https://www.youtube.com/embed/TrTSvn5-MTk', requiresWeights: true },
            'lateral-raises': { name: 'Lateral Raises', video: 'https://www.youtube.com/embed/0o07iGKUarI', requiresWeights: true }
        };

        let selectedWeight = 5;
        let currentExercise;
        let exerciseLog = [];
        let countdownInterval;

        // Handle form submission
        document.getElementById('personalize-form').addEventListener('submit', function (event) {
            event.preventDefault();
            const focus = document.getElementById('focus').value;
            currentExercise = exercises[focus];

            // Update the exercise name and video
            document.getElementById('exercise-name').textContent = currentExercise.name;
            document.getElementById('weights').style.display = currentExercise.requiresWeights ? 'block' : 'none';

            document.getElementById('personalization').style.display = 'none';
            document.getElementById('exercise').style.display = 'block';
        });

        // Update weight display
        document.getElementById('weights').addEventListener('input', function () {
            selectedWeight = this.value;
            document.getElementById('selected-weight').textContent = selectedWeight;
        });

        // Handle Watch Video or Skip
        document.getElementById('watch-video').addEventListener('click', function () {
            document.getElementById('exercise').style.display = 'none';
            document.getElementById('video-frame').src = currentExercise.video;
            document.getElementById('video-page').style.display = 'block';
        });

        document.getElementById('skip-video').addEventListener('click', function () {
            document.getElementById('exercise').style.display = 'none';
            document.getElementById('posture-correction').style.display = 'block';
        });

        // Handle video continue
        document.getElementById('continue-video').addEventListener('click', function () {
            document.getElementById('video-page').style.display = 'none';
            document.getElementById('posture-correction').style.display = 'block';
        });

        // Handle posture correction skip
        document.getElementById('skip-camera').addEventListener('click', function () {
            document.getElementById('posture-correction').style.display = 'none';
            document.getElementById('personalization').style.display = 'block'; // Go back to start
        });

        // Handle camera enable
        document.getElementById('enable-camera').addEventListener('click', function () {
            document.getElementById('posture-correction').style.display = 'none';
            document.getElementById('camera-page').style.display = 'block';
            startCamera();
        });

        // Handle camera continue
        document.getElementById('continue-camera').addEventListener('click', function () {
            document.getElementById('camera-page').style.display = 'none';
            stopCamera();
            startCountdown();
        });

        // Handle posture correction skip
        document.getElementById('skip-camera').addEventListener('click', function () {
            document.getElementById('posture-correction').style.display = 'none';
            startCountdown();
        });

        // Start camera
        function startCamera() {
            const video = document.getElementById('camera-feed');
            const countdownElement = document.getElementById('camera-countdown');

            navigator.mediaDevices.getUserMedia({ video: true })
                .then(stream => {
                    video.srcObject = stream;
                    video.play();
                    let countdown = 10;
                    countdownElement.textContent = `Posture correction in: ${countdown} seconds`;
                    countdownInterval = setInterval(() => {
                        countdownElement.textContent = `Posture correction in: ${countdown--} seconds`;
                        if (countdown < 0) {
                            clearInterval(countdownInterval);
                            countdownElement.textContent = 'Posture correction complete.';
                        }
                    }, 1000);
                })
                .catch(error => {
                    console.error('Error accessing camera:', error);
                });
        }

        // Stop camera
        function stopCamera() {
            const video = document.getElementById('camera-feed');
            const stream = video.srcObject;
            const tracks = stream.getTracks();
            tracks.forEach(track => track.stop());
            video.srcObject = null;
        }

        // Start countdown for exercise
        function startCountdown() {
            document.getElementById('countdown-log').style.display = 'block';
            let countdown = 10;
            const countdownElement = document.getElementById('countdown-timer');
            countdownElement.textContent = `Starting in: ${countdown} seconds`;
            countdownInterval = setInterval(() => {
                countdownElement.textContent = `Starting in: ${countdown--} seconds`;
                if (countdown < 0) {
                    clearInterval(countdownInterval);
                    countdownElement.textContent = 'Begin your exercise!';
                    // Assume exercise is done after 10 seconds for demo purposes
                    setTimeout(() => {
                        document.getElementById('done-exercise').style.display = 'block';
                    }, 10000);
                }
            }, 1000);
        }

        // Handle done exercise
        document.getElementById('done-exercise').addEventListener('click', function () {
            document.getElementById('countdown-log').style.display = 'none';
            logExercise();
        });

        // Log exercise to workout log
        function logExercise() {
            const logEntry = `${currentExercise.name} - ${selectedWeight} kg`;
            exerciseLog.push(logEntry);

            // Update log page
            const logElement = document.getElementById('exercise-log');
            const listItem = document.createElement('li');
            listItem.textContent = logEntry;
            logElement.appendChild(listItem);

            document.getElementById('log-page').style.display = 'block';
        }

        // Handle do another exercise
        document.getElementById('do-another-exercise').addEventListener('click', function () {
            document.getElementById('log-page').style.display = 'none';
            document.getElementById('personalization').style.display = 'block';
        });

        // Handle finish workout from exercise log
        document.getElementById('finish-workout-log').addEventListener('click', function () {
            displaySummary();
        });

        // Handle finish workout from exercise page
        document.getElementById('finish-workout-exercise').addEventListener('click', function () {
            document.getElementById('exercise').style.display = 'none';
            displaySummary();
        });

        // Display workout summary
        function displaySummary() {
            document.getElementById('log-page').style.display = 'none';
            const summaryElement = document.getElementById('summary-log');
            summaryElement.innerHTML = ''; // Clear previous entries
            exerciseLog.forEach(logEntry => {
                const listItem = document.createElement('li');
                listItem.textContent = logEntry;
                summaryElement.appendChild(listItem);
            });
            document.getElementById('workout-summary').style.display = 'block';
        }
    </script>
</body>
</html>
